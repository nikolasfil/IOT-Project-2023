{{>header}}

<main class="d-flex flex-column align-content-center pageborder" style="background: #2B1756">
    {{!-- Den kserw giati thelei extra div gia na mpoun mazi alla doulevei  --}}
    <div class="gen-info-assigned">
        <div>
            <div class="general-info" id="device">

                <h2 style="color: #FFFFFF; align-self: center"><strong>General Info</strong></h2>
                {{!-- <h1 id="title"><strong>device Title</strong></h1> --}}
                {{!-- <img src=".card_device_default.jpg" alt="device cover" class="device-img m-3"> --}}
                <div class="info-container">
                    <div class="id-title" id="device-title-summary">
                        <h1 id="title" style="color: #FFFFFF"><strong>ID: {{ device.d_id }}</strong></h1>
                        {{#if (eq device.type "Buttons")}}
                            <div class="col">
                                <img src="/img/button.png" alt="device cover" class="device-img m-3" width="200px">
                            </div>
                        {{else}}
                            <div class="col">
                                <img src="/img/gps-over.png" alt="device cover" class="device-img m-3" width="200px"
                                     style="background: #6F518C; border-radius: 15px">
                            </div>

                        {{/if}}
                    </div>
                    <div class="info-grid" id="device-info">
                        {{!-- These attributes need changing --}}
                        {{> info_grid device=device}}
                    </div>
                </div>

            </div>

            <div class="assigned-user" id="device-assigned-user">
                {{#if isAdmin}}
                    {{#if assignedUser}}
                    {{!-- Make a divider that will be able to fetch user info --}}
                    {{!-- And be able to update them  --}}
                    <h2 style="color: #FFFFFF"><strong>Assigned User</strong></h2>
                    <div class="info-container"></div>
                    {{> user_profile_info id=assignedUser.user_id role=assignedUser.role phone=assignedUser.phone}}
                    {{else}}
                    {{> assigning_user}}
                    {{/if}}
                {{/if}}
            </div>
        </div>

    </div>
    <br>
    <div class="map-divider">
        {{!-- This is where the Map is going to go  --}}
        <div class="row justify-content-start " id="device-location">

            <div class="col">

                {{!--  --}}
                {{#if (eq device.type "Buttons")}}
                <div class="row">
                    <h4 class="col">Event</h4>
                    <h4 class="col">Date</h4>
                    <h4 class="col">Time</h4>
                </div>
                {{!-- For the context provider information --}}
                {{> button_presses event=context.event.value date=context.timestamp.value.date time=context.timestamp.value.time}}
                
                {{!-- For the database  --}}
                {{> button_presses_list device=devicePresses}}

                {{else }}
                <h2 style="color: #FFFFFF;align-self: start"><strong>Map And History</strong></h2>
                {{> heatmap_device}}
                {{!-- Button Presses  --}}
                {{/if}}
            </div>
            <div class="col resLibraries">

                {{> deviceHistoryList device=deviceHistory}}

            </div>

        </div>
    </div>


</main>